{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export function createMarkup(data) {\n    return data\n      .map(\n        ({\n          id,\n          webformatURL,\n          largeImageURL,\n          views,\n          likes,\n          comments,\n          downloads,\n          tags,\n        }) => {\n          return `\n      <a href=\"${largeImageURL}\" class=\"card\">\n         <img class=\"card__img\" src=\"${webformatURL}\" alt=\"${tags}\"/>\n         <div class=\"card__info\">\n           <p class=\"card__numbers\"><span>Views:</span> ${views}</p>\n           <p class=\"card__numbers\"><span>Likes:</span> ${likes}</p>\n           <p class=\"card__numbers\"><span>Comments:</span> ${comments}</p>\n           <p class=\"card__numbers\"><span>Downloads:</span> ${downloads}</p>\n         </div>\n      </a>\n      `;\n        }\n      )\n      .join('');\n  }\n  ","import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com';\nconst END_POINT = '/api/';\nconst API_KEY = '15968525-5a53092c6d62a7b9e458a529a';\n\nexport async function getImages(query, page = 1, perPage = 18) {\n\n  const headers = {\n    Accept: 'application/json',\n    'Content-Type': 'application/json',\n  };\n  const url = `${BASE_URL}${END_POINT}`;\n  try {\n    const res = await axios.get(url, {\n      params: {\n        key: API_KEY,\n        image_type: 'photo',\n        safesearch: true,\n        orientation: 'horizontal',\n        q: query,\n        page: page,\n        per_page: perPage,\n      },\n      headers: {\n        ...headers\n      }\n    });\n    return res.data;\n  } catch (error) {\n    if (error.response) {\n      iziToast.error({\n        title: 'Error',\n        message: `HTTP error! status: ${error.response.status} - ${error.response.statusText}`,\n      });\n    } else {\n      iziToast.error({\n        title: 'Error',\n        message: error.message,\n      });\n    }\n    return;\n  }\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { createMarkup } from './js/render-functions';\nimport { getImages } from './js/pixabay-api';\n\nconst searchForm = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst fotoGallery = new SimpleLightbox('.gallery a');\nconst loader = document.querySelector('.loader');\nconst loaderOverlay = document.querySelector('.loader__overlay');\nconst loadMoreBtn = document.querySelector('.js-load-more');\n\nlet page = 1;\nconst perPage = 18;\n\nfunction waitForImagesToLoad() {\n  const images = gallery.querySelectorAll('img');\n  const imagePromises = Array.from(images).map(img => {\n    return new Promise((resolve, reject) => {\n      if (img.complete) {\n        resolve();\n      } else {\n        img.onload = resolve;\n        img.onerror = reject;\n      }\n    });\n  });\n  return Promise.all(imagePromises);\n}\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  if (event.target.classList.contains('form')) {\n    gallery.innerHTML = '';\n    page = 1;\n    loader.style.display = 'block';\n    loaderOverlay.style.display = 'block';\n    // setTimeout(() => {\n    //   loader.style.display = 'none';\n    //   loaderOverlay.style.display = 'none';\n    // }, 1000);\n  }\n  const searchQuery = searchForm.elements.search.value.trim();\n  if (!searchQuery) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Empty query',\n      messageColor: '#fff',\n    });\n    loader.style.display = 'none';\n    loaderOverlay.style.display = 'none';\n    return;\n  }\n  await getImages(searchQuery, page, perPage)\n    .then(async data => {\n      const totalHints = data.totalHits;\n\n      if (data.hits.length === 0) {\n        gallery.innerHTML = '';\n        loadMoreBtn.classList.add('load-more-hidden');\n        loader.style.display = 'none';\n        loaderOverlay.style.display = 'none';\n        throw new Error(\n          'Sorry, there are no images matching your search query. Please try again!'\n        );\n      }\n      const markup = createMarkup(data.hits);\n      gallery.insertAdjacentHTML('beforeend', markup);\n      fotoGallery.refresh();\n\n      await waitForImagesToLoad();\n\n      iziToast.success({\n        title: 'Success',\n        message: 'Images loaded successfully',\n        messageColor: '#fff',\n      });\n      loader.style.display = 'none';\n      loaderOverlay.style.display = 'none';\n      if (page * perPage >= totalHints) {\n        iziToast.success({\n          title: 'Warning',\n          message: \"We're sorry, but you've reached the end of search results.\",\n          messageColor: 'red',\n        });\n        loadMoreBtn.classList.add('load-more-hidden');\n      }\n\n      if (page === 1 && totalHints > perPage) {\n        loadMoreBtn.classList.remove('load-more-hidden');\n      }\n      if (event.target.classList.contains('form')) {\n        return;\n      }\n      let cardImg = document.querySelector('.card__img');\n      window.scrollBy({\n        top: cardImg.height * 2 + 48,\n        left: 0,\n        behavior: 'smooth',\n      });\n    })\n    .catch(error => {\n      iziToast.error({\n        title: 'Error',\n        message: error.message,\n        backgroundColor: '#EF4040',\n        iconColor: '#ffffff',\n        messageColor: '#fff',\n      });\n    })\n    .finally(data => {\n      page++;\n    });\n}\nsearchForm.addEventListener('submit', handleSubmit);\n\nloadMoreBtn.addEventListener('click', handleSubmit);\n"],"names":["createMarkup","data","id","webformatURL","largeImageURL","views","likes","comments","downloads","tags","BASE_URL","END_POINT","API_KEY","getImages","query","page","perPage","headers","url","axios","error","searchForm","gallery","fotoGallery","SimpleLightbox","loader","loaderOverlay","loadMoreBtn","waitForImagesToLoad","images","imagePromises","img","resolve","reject","handleSubmit","event","searchQuery","iziToast","totalHints","markup","cardImg"],"mappings":"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"}